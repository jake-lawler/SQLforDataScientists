<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 SQL JOINs | Notes on ‘SQL for Data Scientists’ by Renée M. P. Teate</title>
  <meta name="description" content="My Notes on ‘SQL for Data Scientists’." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 SQL JOINs | Notes on ‘SQL for Data Scientists’ by Renée M. P. Teate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My Notes on ‘SQL for Data Scientists’." />
  <meta name="github-repo" content="jake-lawler/SQLforDataScientists" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 SQL JOINs | Notes on ‘SQL for Data Scientists’ by Renée M. P. Teate" />
  
  <meta name="twitter:description" content="My Notes on ‘SQL for Data Scientists’." />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2022-04-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="case.html"/>
<link rel="next" href="aggregating.html"/>
<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data_sources.html"><a href="data_sources.html"><i class="fa fa-check"></i><b>1</b> Data Sources</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data_sources.html"><a href="data_sources.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="data_sources.html"><a href="data_sources.html#exercises"><i class="fa fa-check"></i><b>1.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="data_sources.html"><a href="data_sources.html#ex.-1"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="data_sources.html"><a href="data_sources.html#ex.-2"><i class="fa fa-check"></i>Ex. 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="select.html"><a href="select.html"><i class="fa fa-check"></i><b>2</b> The SELECT Statement</a>
<ul>
<li class="chapter" data-level="2.1" data-path="select.html"><a href="select.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="select.html"><a href="select.html#exercises-1"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="select.html"><a href="select.html#ex.-1-1"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="select.html"><a href="select.html#ex.-2-1"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="select.html"><a href="select.html#ex.-3"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="where.html"><a href="where.html"><i class="fa fa-check"></i><b>3</b> The WHERE Clause</a>
<ul>
<li class="chapter" data-level="3.1" data-path="where.html"><a href="where.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="where.html"><a href="where.html#exercises-2"><i class="fa fa-check"></i><b>3.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="where.html"><a href="where.html#ex.-1-2"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="where.html"><a href="where.html#ex.-2-2"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="where.html"><a href="where.html#ex.-3-1"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case.html"><a href="case.html"><i class="fa fa-check"></i><b>4</b> CASE Statements</a>
<ul>
<li class="chapter" data-level="4.1" data-path="case.html"><a href="case.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="4.2" data-path="case.html"><a href="case.html#exercises-3"><i class="fa fa-check"></i><b>4.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="case.html"><a href="case.html#ex.-1-3"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="case.html"><a href="case.html#ex.-2-3"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="case.html"><a href="case.html#ex.-3-2"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sql_joins.html"><a href="sql_joins.html"><i class="fa fa-check"></i><b>5</b> SQL JOINs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sql_joins.html"><a href="sql_joins.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="sql_joins.html"><a href="sql_joins.html#exercises-4"><i class="fa fa-check"></i><b>5.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="sql_joins.html"><a href="sql_joins.html#ex.-1-4"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="sql_joins.html"><a href="sql_joins.html#ex.-2-4"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="sql_joins.html"><a href="sql_joins.html#ex.-3-3"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aggregating.html"><a href="aggregating.html"><i class="fa fa-check"></i><b>6</b> Aggregating Results for Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aggregating.html"><a href="aggregating.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="6.2" data-path="aggregating.html"><a href="aggregating.html#exercises-5"><i class="fa fa-check"></i><b>6.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="aggregating.html"><a href="aggregating.html#ex.-1-5"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="aggregating.html"><a href="aggregating.html#ex.-2-5"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="aggregating.html"><a href="aggregating.html#ex.-3-4"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="window_functions.html"><a href="window_functions.html"><i class="fa fa-check"></i><b>7</b> Window Functions and Subqueries</a>
<ul>
<li class="chapter" data-level="7.1" data-path="window_functions.html"><a href="window_functions.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="7.2" data-path="window_functions.html"><a href="window_functions.html#exercises-6"><i class="fa fa-check"></i><b>7.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="window_functions.html"><a href="window_functions.html#ex.-1-6"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="window_functions.html"><a href="window_functions.html#ex.-2-6"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="window_functions.html"><a href="window_functions.html#ex.-3-5"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="date_time.html"><a href="date_time.html"><i class="fa fa-check"></i><b>8</b> Date and Time Functions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="date_time.html"><a href="date_time.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="8.2" data-path="date_time.html"><a href="date_time.html#exercises-7"><i class="fa fa-check"></i><b>8.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="date_time.html"><a href="date_time.html#ex.-1-7"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="date_time.html"><a href="date_time.html#ex.-2-7"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="date_time.html"><a href="date_time.html#ex.-3-6"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="date_time.html"><a href="date_time.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html"><i class="fa fa-check"></i><b>9</b> Exploratory Data Analysis with SQL</a>
<ul>
<li class="chapter" data-level="9.1" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="9.2" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html#exercises-8"><i class="fa fa-check"></i><b>9.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html#ex.-1-8"><i class="fa fa-check"></i>Ex. 1</a></li>
<li class="chapter" data-level="" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html#ex.-2-8"><i class="fa fa-check"></i>Ex. 2</a></li>
<li class="chapter" data-level="" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html#ex.-3-7"><i class="fa fa-check"></i>Ex. 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exploratory_analysis.html"><a href="exploratory_analysis.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="building_datasets.html"><a href="building_datasets.html"><i class="fa fa-check"></i><b>10</b> Building SQL Datasets for Analytical Reporting</a>
<ul>
<li class="chapter" data-level="10.1" data-path="building_datasets.html"><a href="building_datasets.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="10.2" data-path="building_datasets.html"><a href="building_datasets.html#exercises-9"><i class="fa fa-check"></i><b>10.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="building_datasets.html"><a href="building_datasets.html#ex.-1-9"><i class="fa fa-check"></i>Ex. 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building_datasets.html"><a href="building_datasets.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes on ‘SQL for Data Scientists’ by Renée M. P. Teate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sql_joins" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> SQL JOINs</h1>
<div id="chapter-notes-4" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Chapter Notes</h2>
<p>JOINs are used to pull data from across multiple related tables.</p>
<p>Let’s say we want to list the name of each product along with it’s category. These are stored in different tables:</p>
<p><img src="images/Ch05Img01.png" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb39-1"><a href="sql_joins.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb39-2"><a href="sql_joins.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product </span>
<span id="cb39-3"><a href="sql_joins.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> product_category</span>
<span id="cb39-4"><a href="sql_joins.html#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> product.product_category_id <span class="op">=</span> product_category.product_category_id</span>
<span id="cb39-5"><a href="sql_joins.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span></span></code></pre></div>
<div class="knitsql-table">
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-2">Table 2.1: </span>5 records</caption>
<colgroup>
<col width="8%" />
<col width="19%" />
<col width="9%" />
<col width="14%" />
<col width="12%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">product_id</th>
<th align="left">product_name</th>
<th align="left">product_size</th>
<th align="right">product_category_id</th>
<th align="left">product_qty_type</th>
<th align="right">product_category_id..6</th>
<th align="left">product_category_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">medium</td>
<td align="right">1</td>
<td align="left">lbs</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">Jalapeno Peppers - Organic</td>
<td align="left">small</td>
<td align="right">1</td>
<td align="left">lbs</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">Poblano Peppers - Organic</td>
<td align="left">large</td>
<td align="right">1</td>
<td align="left">unit</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">Banana Peppers - Jar</td>
<td align="left">8 oz</td>
<td align="right">3</td>
<td align="left">unit</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">Whole Wheat Bread</td>
<td align="left">1.5 lbs</td>
<td align="right">3</td>
<td align="left">unit</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
</tbody>
</table>
</div>
<p>The code above stitches together the product table and the product_category table, used the product_category_id column in each. This is a LEFT JOIN, which means:</p>
<ul>
<li>All rows in the product table are kept, even if there are no matches in the product_category table</li>
<li>Rows in the product_category table for IDs that don’t appear in the product table are dropped. If there are no products in the product table with product_category_id 7 (Non-Edible Products), then that row of the product_category table will not appear in the results.</li>
</ul>
<p>Also, the code above is the first time I’ve seen the code not specify the database. I.e. it refers to product instead of farmers_market.product. I’m not exactly sure about when this can be left out, but it’s not specific to JOINs at all - the farmers_market part can be removed from the queries in previous chapters and the code will still run.</p>
<p>Note that product_category_id appears in the results above twice - one from each table (although I believe R is adding “..6” to the second one, since it doesn’t like data frames with multiple columns with the same name). We could prevent this by specifying which columns to include, or by creating an alias for the column names that specifies which table each ID column came from:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb40-1"><a href="sql_joins.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> product.product_id, </span>
<span id="cb40-2"><a href="sql_joins.html#cb40-2" aria-hidden="true" tabindex="-1"></a>        product.product_name, </span>
<span id="cb40-3"><a href="sql_joins.html#cb40-3" aria-hidden="true" tabindex="-1"></a>        product.product_category_id <span class="kw">AS</span> product_prod_cat_id, </span>
<span id="cb40-4"><a href="sql_joins.html#cb40-4" aria-hidden="true" tabindex="-1"></a>        product_category.product_category_id <span class="kw">AS</span> category_prod_cat_id, </span>
<span id="cb40-5"><a href="sql_joins.html#cb40-5" aria-hidden="true" tabindex="-1"></a>        product_category.product_category_name</span>
<span id="cb40-6"><a href="sql_joins.html#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product </span>
<span id="cb40-7"><a href="sql_joins.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> product_category</span>
<span id="cb40-8"><a href="sql_joins.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> product.product_category_id <span class="op">=</span> product_category.product_category_id</span>
<span id="cb40-9"><a href="sql_joins.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-3">Table 2.2: </span>5 records</caption>
<colgroup>
<col width="10%" />
<col width="25%" />
<col width="19%" />
<col width="20%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">product_id</th>
<th align="left">product_name</th>
<th align="right">product_prod_cat_id</th>
<th align="right">category_prod_cat_id</th>
<th align="left">product_category_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">Jalapeno Peppers - Organic</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">Poblano Peppers - Organic</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">Banana Peppers - Jar</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">Whole Wheat Bread</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
</tbody>
</table>
</div>
<p>The chapter also demonstrates aliasing that is used to shorten the table names in the rest of the query for convenience. It doesn’t affect results. In the code that follows the product table is aliased as “p” and the product_category table is aliased as “pc”.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb41-1"><a href="sql_joins.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> p.product_id, </span>
<span id="cb41-2"><a href="sql_joins.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  p.product_name, </span>
<span id="cb41-3"><a href="sql_joins.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  pc.product_category_id, </span>
<span id="cb41-4"><a href="sql_joins.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  pc.product_category_name</span>
<span id="cb41-5"><a href="sql_joins.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product <span class="kw">AS</span> p </span>
<span id="cb41-6"><a href="sql_joins.html#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> product_category <span class="kw">AS</span> pc </span>
<span id="cb41-7"><a href="sql_joins.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> p.product_category_id <span class="op">=</span> pc.product_category_id</span>
<span id="cb41-8"><a href="sql_joins.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> pc.product_category_name, p.product_name</span>
<span id="cb41-9"><a href="sql_joins.html#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-4">Table 2.3: </span>5 records</caption>
<colgroup>
<col width="12%" />
<col width="32%" />
<col width="22%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">product_id</th>
<th align="left">product_name</th>
<th align="right">product_category_id</th>
<th align="left">product_category_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="left">Eggs</td>
<td align="right">6</td>
<td align="left">Eggs &amp; Meat (Fresh or Frozen)</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="left">Pork Chops</td>
<td align="right">6</td>
<td align="left">Eggs &amp; Meat (Fresh or Frozen)</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">Baby Salad Lettuce Mix</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">Baby Salad Lettuce Mix - Bag</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="left">Carrots</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
</tbody>
</table>
</div>
<p>You can see the shortened table names used in the SELECT clause, and when specifying the joining columns and ordering.</p>
<p>In general with aliasing, the AS keyword is optional. The code “product AS p” and “product p” will do the same thing.</p>
<p>RIGHT JOINs work analogously:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb42-1"><a href="sql_joins.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> p.product_id, </span>
<span id="cb42-2"><a href="sql_joins.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  p.product_name, </span>
<span id="cb42-3"><a href="sql_joins.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  pc.product_category_id, </span>
<span id="cb42-4"><a href="sql_joins.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  pc.product_category_name</span>
<span id="cb42-5"><a href="sql_joins.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product <span class="kw">AS</span> p </span>
<span id="cb42-6"><a href="sql_joins.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> product_category <span class="kw">AS</span> pc </span>
<span id="cb42-7"><a href="sql_joins.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> p.product_category_id <span class="op">=</span> pc.product_category_id</span>
<span id="cb42-8"><a href="sql_joins.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> p.product_name</span>
<span id="cb42-9"><a href="sql_joins.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-5">Table 0.1: </span>5 records</caption>
<colgroup>
<col width="12%" />
<col width="33%" />
<col width="23%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">product_id</th>
<th align="left">product_name</th>
<th align="right">product_category_id</th>
<th align="left">product_category_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">4</td>
<td align="left">Freshly Prepared Food</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="left">Apple Pie</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">Baby Salad Lettuce Mix</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">Baby Salad Lettuce Mix - Bag</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">Banana Peppers - Jar</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
</tbody>
</table>
</div>
<p>A couple points to note about these results.</p>
<ul>
<li>All rows from the product_category table are included, even when no product is assigned to that category. In the table above, no products are in category 4 (Freshly Prepared Food), but it still appears in the results.</li>
<li>Rows from the product_category table can be included multiple times. The results above (when not using LIMIT) will have 24 rows, one for each of the 23 products plus 1 for category 4.</li>
</ul>
<p>If there could be multiple product categories for each product, then they would both appear in the left join performed above, so the results would have more than 23 rows.</p>
<p>INNER JOINs keep only rows where the product_category_id appears in both tables:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb43-1"><a href="sql_joins.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> p.product_id, </span>
<span id="cb43-2"><a href="sql_joins.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  p.product_name, </span>
<span id="cb43-3"><a href="sql_joins.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  pc.product_category_id, </span>
<span id="cb43-4"><a href="sql_joins.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  pc.product_category_name</span>
<span id="cb43-5"><a href="sql_joins.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product <span class="kw">AS</span> p </span>
<span id="cb43-6"><a href="sql_joins.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> product_category <span class="kw">AS</span> pc </span>
<span id="cb43-7"><a href="sql_joins.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> p.product_category_id <span class="op">=</span> pc.product_category_id</span>
<span id="cb43-8"><a href="sql_joins.html#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> p.product_name</span>
<span id="cb43-9"><a href="sql_joins.html#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-6">Table 2.4: </span>5 records</caption>
<colgroup>
<col width="12%" />
<col width="33%" />
<col width="23%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">product_id</th>
<th align="left">product_name</th>
<th align="right">product_category_id</th>
<th align="left">product_category_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">7</td>
<td align="left">Apple Pie</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="left">Baby Salad Lettuce Mix</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="left">Baby Salad Lettuce Mix - Bag</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Banana Peppers - Jar</td>
<td align="right">3</td>
<td align="left">Packaged Prepared Food</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="left">Carrots</td>
<td align="right">1</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
</tr>
</tbody>
</table>
</div>
<p>In this case the results are the same as the left join, since each product has an assigned product_category_id.</p>
<p>Joins can be performed multiple times, with the second join effectively acting to join together the results of the first join with another table.</p>
</div>
<div id="exercises-4" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Exercises</h2>
<div id="ex.-1-4" class="section level3 unnumbered">
<h3>Ex. 1</h3>
<div id="question-11" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Write a query that INNER JOINs the vendor table to the vendor_booth_assignments table on the vendor_id field they both have in common, and sorts the result by vendor_name , then market_date.</p>
</blockquote>
</div>
<div id="answer-11" class="section level4 unnumbered">
<h4>Answer</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb44-1"><a href="sql_joins.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb44-2"><a href="sql_joins.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> vendor <span class="kw">AS</span> v</span>
<span id="cb44-3"><a href="sql_joins.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> vendor_booth_assignments <span class="kw">AS</span> vba</span>
<span id="cb44-4"><a href="sql_joins.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> v.vendor_id <span class="op">=</span> vba.vendor_id</span>
<span id="cb44-5"><a href="sql_joins.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> vendor_name, market_date</span>
<span id="cb44-6"><a href="sql_joins.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span></span></code></pre></div>
<div class="knitsql-table">
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-7">Table 2.5: </span>5 records</caption>
<colgroup>
<col width="8%" />
<col width="10%" />
<col width="12%" />
<col width="19%" />
<col width="18%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">vendor_id</th>
<th align="left">vendor_name</th>
<th align="left">vendor_type</th>
<th align="left">vendor_owner_first_name</th>
<th align="left">vendor_owner_last_name</th>
<th align="right">vendor_id..6</th>
<th align="right">booth_number</th>
<th align="left">market_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">8</td>
<td align="left">Annie’s Pies</td>
<td align="left">Prepared Foods</td>
<td align="left">Annie</td>
<td align="left">Aquinas</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="left">2019-04-03</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">Annie’s Pies</td>
<td align="left">Prepared Foods</td>
<td align="left">Annie</td>
<td align="left">Aquinas</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="left">2019-04-06</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="left">Annie’s Pies</td>
<td align="left">Prepared Foods</td>
<td align="left">Annie</td>
<td align="left">Aquinas</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="left">2019-04-10</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">Annie’s Pies</td>
<td align="left">Prepared Foods</td>
<td align="left">Annie</td>
<td align="left">Aquinas</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="left">2019-04-13</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="left">Annie’s Pies</td>
<td align="left">Prepared Foods</td>
<td align="left">Annie</td>
<td align="left">Aquinas</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="left">2019-04-17</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ex.-2-4" class="section level3 unnumbered">
<h3>Ex. 2</h3>
<div id="question-12" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Is it possible to write a query that produces an output identical to the output of the following query, but using a LEFT JOIN instead of a RIGHT JOIN?</p>
</blockquote>
<div class="sourceCode" id="cb45"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb45-1"><a href="sql_joins.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb45-2"><a href="sql_joins.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer <span class="kw">AS</span> c </span>
<span id="cb45-3"><a href="sql_joins.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> customer_purchases <span class="kw">AS</span> cp</span>
<span id="cb45-4"><a href="sql_joins.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> c.customer_id <span class="op">=</span> cp.customer_id</span>
<span id="cb45-5"><a href="sql_joins.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-8">Table 2.6: </span>10 records</caption>
<colgroup>
<col width="7%" />
<col width="12%" />
<col width="11%" />
<col width="7%" />
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="9%" />
<col width="5%" />
<col width="15%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">customer_id</th>
<th align="left">customer_first_name</th>
<th align="left">customer_last_name</th>
<th align="left">customer_zip</th>
<th align="right">product_id</th>
<th align="right">vendor_id</th>
<th align="left">market_date</th>
<th align="right">customer_id..8</th>
<th align="right">quantity</th>
<th align="right">cost_to_customer_per_qty</th>
<th align="left">transaction_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">14</td>
<td align="left">William</td>
<td align="left">Lopes</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">14</td>
<td align="right">0.99</td>
<td align="right">6.99</td>
<td align="left">17:32:00</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">William</td>
<td align="left">Lopes</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">14</td>
<td align="right">2.18</td>
<td align="right">6.99</td>
<td align="left">18:23:00</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">Darrell</td>
<td align="left">Messina</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">15</td>
<td align="right">1.53</td>
<td align="right">6.99</td>
<td align="left">18:41:00</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">Ada</td>
<td align="left">Nieves</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">16</td>
<td align="right">2.02</td>
<td align="right">6.99</td>
<td align="left">18:18:00</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="left">George</td>
<td align="left">Rai</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">22</td>
<td align="right">0.66</td>
<td align="right">6.99</td>
<td align="left">17:34:00</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Deanna</td>
<td align="left">Washington</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">4</td>
<td align="right">0.27</td>
<td align="right">6.99</td>
<td align="left">12:20:00</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="left">Jack</td>
<td align="left">Wise</td>
<td align="left">22821</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">12</td>
<td align="right">3.60</td>
<td align="right">6.99</td>
<td align="left">09:33:00</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">William</td>
<td align="left">Lopes</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">14</td>
<td align="right">3.04</td>
<td align="right">6.99</td>
<td align="left">13:05:00</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="left">Alvin</td>
<td align="left">Laurie</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">23</td>
<td align="right">1.49</td>
<td align="right">6.99</td>
<td align="left">12:26:00</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="left">Alvin</td>
<td align="left">Laurie</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">23</td>
<td align="right">2.56</td>
<td align="right">6.99</td>
<td align="left">12:46:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="answer-12" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Probably there’s a less clumsy way of getting the columns in the right order, but this works:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb46-1"><a href="sql_joins.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> c.customer_id,</span>
<span id="cb46-2"><a href="sql_joins.html#cb46-2" aria-hidden="true" tabindex="-1"></a>        c.customer_first_name,</span>
<span id="cb46-3"><a href="sql_joins.html#cb46-3" aria-hidden="true" tabindex="-1"></a>        c.customer_last_name,</span>
<span id="cb46-4"><a href="sql_joins.html#cb46-4" aria-hidden="true" tabindex="-1"></a>        c.customer_zip,</span>
<span id="cb46-5"><a href="sql_joins.html#cb46-5" aria-hidden="true" tabindex="-1"></a>        cp.product_id,</span>
<span id="cb46-6"><a href="sql_joins.html#cb46-6" aria-hidden="true" tabindex="-1"></a>        cp.vendor_id,</span>
<span id="cb46-7"><a href="sql_joins.html#cb46-7" aria-hidden="true" tabindex="-1"></a>        cp.market_date, </span>
<span id="cb46-8"><a href="sql_joins.html#cb46-8" aria-hidden="true" tabindex="-1"></a>        cp.customer_id,</span>
<span id="cb46-9"><a href="sql_joins.html#cb46-9" aria-hidden="true" tabindex="-1"></a>        cp.quantity,</span>
<span id="cb46-10"><a href="sql_joins.html#cb46-10" aria-hidden="true" tabindex="-1"></a>        cp.cost_to_customer_per_qty,</span>
<span id="cb46-11"><a href="sql_joins.html#cb46-11" aria-hidden="true" tabindex="-1"></a>        cp.transaction_time </span>
<span id="cb46-12"><a href="sql_joins.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_purchases <span class="kw">AS</span> cp </span>
<span id="cb46-13"><a href="sql_joins.html#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> customer <span class="kw">AS</span> c</span>
<span id="cb46-14"><a href="sql_joins.html#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> cp.customer_id <span class="op">=</span> c.customer_id</span>
<span id="cb46-15"><a href="sql_joins.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-9">Table 3.1: </span>10 records</caption>
<colgroup>
<col width="7%" />
<col width="12%" />
<col width="11%" />
<col width="7%" />
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="9%" />
<col width="5%" />
<col width="15%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">customer_id</th>
<th align="left">customer_first_name</th>
<th align="left">customer_last_name</th>
<th align="left">customer_zip</th>
<th align="right">product_id</th>
<th align="right">vendor_id</th>
<th align="left">market_date</th>
<th align="right">customer_id..8</th>
<th align="right">quantity</th>
<th align="right">cost_to_customer_per_qty</th>
<th align="left">transaction_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">14</td>
<td align="left">William</td>
<td align="left">Lopes</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">14</td>
<td align="right">0.99</td>
<td align="right">6.99</td>
<td align="left">17:32:00</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">William</td>
<td align="left">Lopes</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">14</td>
<td align="right">2.18</td>
<td align="right">6.99</td>
<td align="left">18:23:00</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">Darrell</td>
<td align="left">Messina</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">15</td>
<td align="right">1.53</td>
<td align="right">6.99</td>
<td align="left">18:41:00</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">Ada</td>
<td align="left">Nieves</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">16</td>
<td align="right">2.02</td>
<td align="right">6.99</td>
<td align="left">18:18:00</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="left">George</td>
<td align="left">Rai</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-03</td>
<td align="right">22</td>
<td align="right">0.66</td>
<td align="right">6.99</td>
<td align="left">17:34:00</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Deanna</td>
<td align="left">Washington</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">4</td>
<td align="right">0.27</td>
<td align="right">6.99</td>
<td align="left">12:20:00</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="left">Jack</td>
<td align="left">Wise</td>
<td align="left">22821</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">12</td>
<td align="right">3.60</td>
<td align="right">6.99</td>
<td align="left">09:33:00</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">William</td>
<td align="left">Lopes</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">14</td>
<td align="right">3.04</td>
<td align="right">6.99</td>
<td align="left">13:05:00</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="left">Alvin</td>
<td align="left">Laurie</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">23</td>
<td align="right">1.49</td>
<td align="right">6.99</td>
<td align="left">12:26:00</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="left">Alvin</td>
<td align="left">Laurie</td>
<td align="left">22801</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="left">2019-07-06</td>
<td align="right">23</td>
<td align="right">2.56</td>
<td align="right">6.99</td>
<td align="left">12:46:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ex.-3-3" class="section level3 unnumbered">
<h3>Ex. 3</h3>
<div id="question-13" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>At the beginning of this chapter, the analytical question “When is each type of fresh fruit or vegetable in season, locally?” was asked, and it was explained that the answer requires data from the product_category table, the product table, and the vendor_inventory table. What type of JOINs do you expect would be needed to combine these three tables in order to be able to answer this question?</p>
</blockquote>
</div>
<div id="answer-13" class="section level4 unnumbered">
<h4>Answer</h4>
<p>I believe this code would get you most of the way there. You just need a way of summarising the range of market_date for each product, which it looks like we might learn in the next chapter.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb47-1"><a href="sql_joins.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> p.product_id,</span>
<span id="cb47-2"><a href="sql_joins.html#cb47-2" aria-hidden="true" tabindex="-1"></a>        p.product_name,</span>
<span id="cb47-3"><a href="sql_joins.html#cb47-3" aria-hidden="true" tabindex="-1"></a>        pc.product_category_name,</span>
<span id="cb47-4"><a href="sql_joins.html#cb47-4" aria-hidden="true" tabindex="-1"></a>        vi.market_date</span>
<span id="cb47-5"><a href="sql_joins.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product <span class="kw">AS</span> p</span>
<span id="cb47-6"><a href="sql_joins.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> product_category <span class="kw">AS</span> pc</span>
<span id="cb47-7"><a href="sql_joins.html#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> p.product_category_id <span class="op">=</span> pc.product_category_id</span>
<span id="cb47-8"><a href="sql_joins.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> vendor_inventory <span class="kw">AS</span> vi</span>
<span id="cb47-9"><a href="sql_joins.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> p.product_id <span class="op">=</span> vi.product_id</span>
<span id="cb47-10"><a href="sql_joins.html#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> <span class="fu">LOWER</span>(product_category_name) <span class="kw">LIKE</span> <span class="ot">&quot;%fruit%&quot;</span></span>
<span id="cb47-11"><a href="sql_joins.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> product_name, market_date</span>
<span id="cb47-12"><a href="sql_joins.html#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span></span></code></pre></div>
<div class="knitsql-table">
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-10">Table 3.2: </span>10 records</caption>
<colgroup>
<col width="14%" />
<col width="37%" />
<col width="33%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">product_id</th>
<th align="left">product_name</th>
<th align="left">product_category_name</th>
<th align="left">market_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">13</td>
<td align="left">Baby Salad Lettuce Mix</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">Baby Salad Lettuce Mix - Bag</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="left">Carrots</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="left">Carrots - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">2019-07-03</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">2019-07-06</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">2019-07-10</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">2019-07-13</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">2019-07-17</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Habanero Peppers - Organic</td>
<td align="left">Fresh Fruits &amp; Vegetables</td>
<td align="left">2019-07-20</td>
</tr>
</tbody>
</table>
</div>
<p>Although we won’t be able to get an answer if there is nothing recorded in the vendor_inventory table for that item, so perhaps we’d be just as well using an INNER JOIN for that second join. However it may be useful to know when the information we want isn’t available, rather than just silently dropping the NULL results.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="case.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aggregating.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-sql_joins.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
